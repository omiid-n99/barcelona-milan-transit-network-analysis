\documentclass{article}
\usepackage{graphicx} % Required for inserting images
\usepackage{float}
\usepackage{subcaption}

\title{Understanding Urban Transit Through Network Science: An Analysis of Milan and Barcelona}

\author {Amir Masoud Aghaei, Artificial Intelligence,\\Gita Javadi, Artificial Intelligence, 0001158007\\
Omid Nejati, Artificial Intelligence, 0001154905\\ Alireza Shahidiani, Artificial Intelligence, 0001154402 }

\date{November 2025}

\begin{document}

\maketitle

\section{Introduction}

Public transportation systems play a central role in the functioning of modern cities, shaping daily mobility, regional accessibility, and long-term urban development. As urban areas continue to expand and population densities increase, the efficiency and resilience of public transport networks have become critical concerns for planners, policymakers, and researchers. The analytical study of these systems has increasingly relied on Social Network Analysis (SNA), a methodological framework capable of capturing the structural properties, connectivity, and navigational efficiency of complex transport infrastructures. By modelling transit stops as nodes and connections as edges, network analysis provides an effective way to uncover patterns that are often difficult to detect using traditional transport engineering approaches.

This project examines and compares the public transportation networks of Milan and Barcelona, two major European cities with extensive, multimodal transit systems. Both cities feature dense urban fabrics, strong commuter flows, and well-integrated bus, tram, and metro services. Their reliance on public transport as a central mobility pillar, together with their availability of standardized GTFS datasets, makes them ideal case studies for evaluating how network topology influences accessibility, resilience, and overall system performance.

Recent research highlights the effectiveness of complex network analysis in identifying structural weaknesses, critical nodes, and opportunities for optimization in public transport networks~\cite{a}. Lin et al.\ (2021) demonstrate that network-theoretic measures such as global efficiency, clustering, and centrality can meaningfully guide improvements in urban mobility planning, helping cities achieve more balanced and sustainable transport systems~\cite{a}. Building on these insights, the present study applies established SNA techniques to evaluate the structural properties of Milan and Barcelona’s transit systems and uncover patterns that may inform future transportation strategies.


\section{Problem and Motivation}

European cities face persistent challenges related to congestion, air pollution, unequal accessibility, and rising mobility demands. Although both Milan and Barcelona have developed extensive public transport infrastructures, it remains difficult to assess how effectively these networks distribute connectivity, maintain resilience under disruptions, and support equitable travel across different urban zones. Traditional performance metrics—such as vehicle frequency or ridership statistics—provide valuable operational information, but they often fail to capture the deeper structural characteristics that influence navigability and long-term system robustness.

This project aims to address this gap by conducting a structural analysis of the public transportation networks of Milan and Barcelona through the lens of Social Network Analysis. Understanding how these networks are organized—where central hubs arise, how communities form, and how efficiently passengers can traverse the system—is essential for identifying vulnerabilities and suggesting improvements. Prior studies, including the work of Lin et al.\ (2021), demonstrate that complex network theory can reveal hidden inefficiencies and structural imbalances in transit systems, offering a powerful framework for optimization and planning~\cite{a}.

To investigate these aspects in a systematic way, the project employs a comprehensive set of network-theoretic measures capable of capturing both local and global properties of the systems. Classical centrality indicators—degree, betweenness, closeness, and eigenvector centrality—are used to identify influential stops, critical transfer points, and the nodes that most strongly shape passenger flows. Structural cohesion and hierarchical organisation are examined through k-core decomposition and modularity-based community detection, which reveal the presence of strong cores, peripheral regions, and coherent subnetworks within each city.

Beyond local structure, the study incorporates global measures to evaluate navigability, efficiency, and resilience. These include global efficiency and average path length, which quantify how easily passengers can move across the entire network; assortativity, which describes whether highly connected stops tend to link to other hubs or peripheral nodes; edge betweenness centrality, which highlights critical routes rather than individual stops; and targeted robustness simulations, which assess how the network behaves under node or edge failures. Together, this set of measures provides a multidimensional analytical framework for comparing the two systems and for uncovering the organisational principles that support—or hinder—urban mobility in Milan and Barcelona.

The main contribution of this study is to provide a quantitative, topology-based comparison of two major European transit networks using publicly available GTFS data and a consistent methodological approach. By examining centrality, community structure, global efficiency, and robustness, the project seeks to identify meaningful similarities and differences in the systems’ structural patterns. Ultimately, this analysis contributes to the broader discussion on data-driven, evidence-based approaches to improving urban mobility and long-term transport sustainability.


\section{Datasets}

This project relies on General Transit Feed Specification (GTFS) datasets describing the public transportation systems of Milan and Barcelona. GTFS is an open, standardized data format that provides detailed information on transit stops, routes, trips, schedules, and service calendars, making it especially suitable for systematic and reproducible transport network analysis.~\cite{c}

The datasets used in this study were obtained from the Transitland platform, a global aggregator of GTFS feeds that provides unified access to data published by transit agencies worldwide~\cite{d}. For Barcelona, we used the official GTFS feed published by Transports Metropolitans de Barcelona (TMB), while for Milan we used the feed provided by Azienda Trasporti Milanesi (ATM). The datasets were downloaded in their original format, requiring no digitization, and ensuring fidelity to the official transit systems.

All GTFS files (such as \texttt{stops.txt}, \texttt{routes.txt}, and \texttt{trips.txt} ) were processed using Python. Data handling and preprocessing were performed with \texttt{pandas} DataFrames~\cite{e}, which provided a flexible framework for merging, filtering, and manipulating the interconnected GTFS tables. To construct the network representations, we modeled stops as nodes and scheduled trips as edges. When multiple trips connected the same pair of stops, the number of weekly services was aggregated and used as an edge weight to approximate service frequency.

Network computations—such as centrality metrics, efficiency measures, and community detection—were performed using the \texttt{NetworkX} library. This enabled the construction of weighted, undirected graphs for each city and ensured a consistent methodology for comparing network structures. Spatial visualizations were created using \texttt{geopandas}, \texttt{folium}, and \texttt{matplotlib}, allowing accurate mapping of transit stops and connections in their real geographic context.

The datasets sourced from Transitland are openly available and do not require any special permissions. Their standardized format, combined with well-established Python tools, ensures a fully reproducible workflow, allowing other researchers to replicate or extend this study without ambiguity.



\section{Methodology}

\subsection{Advanced Topological Metrics}
To move beyond basic connectivity measures (such as Degree Centrality), this study employs advanced spectral and path-based metrics to understand the deeper structure and resilience of the network:

\begin{itemize}
    \item \textbf{Eigenvector Centrality:} Unlike Degree Centrality, which simply counts direct connections, Eigenvector Centrality measures \textit{influence}. A node receives a high score if it is connected to other high-scoring nodes. This metric helps identify ``super-hubs'' that are not merely busy, but are connected to other strategic parts of the network structure.
    
    \item \textbf{Assortativity Coefficient:} This metric measures the correlation between the degrees of connected nodes. A positive coefficient ($r > 0$) indicates a ``Rich-Club'' effect where high-degree hubs tend to connect to other hubs (Assortative). A negative coefficient ($r < 0$) indicates a hierarchical structure where hubs connect primarily to small peripheral nodes (Disassortative).
    
    \item \textbf{Edge Betweenness Centrality:} While most metrics focus on stations (nodes), Edge Betweenness focuses on the physical tracks (edges). It calculates the fraction of all shortest paths in the network that pass through a specific edge. Edges with high scores represent ``bridges'' or ``bottlenecks''—critical infrastructure pieces whose failure would disproportionately disrupt global network efficiency.
    
    \item \textbf{Community Detection (Modularity):} To understand the functional zoning of the city, we applied Modularity Optimization (using the Clauset-Newman-Moore algorithm). This method partitions the network into communities where the density of internal edges is significantly higher than expected by chance, effectively revealing the ``natural neighborhoods'' of the transport system without relying on geographic coordinates.
\end{itemize}



\section{Results and Discussion}

\subsection{Network Influence and Connectivity Patterns}

\subsubsection{Eigenvector Centrality: Core vs. Corridor Influence}
The Eigenvector Centrality analysis revealed a fundamental difference in how influence is distributed across the two cities:

\begin{itemize}
    \item \textbf{Milan (Centralized Power):} The most influential nodes were identified as \textit{Centrale FS}, \textit{Garibaldi FS}, and \textit{Zara}. This confirms that Milan’s network relies heavily on its central railway and metro interchanges. The influence is concentrated in the geographic center and diminishes rapidly towards the periphery.
    \item \textbf{Barcelona (Strategic Corridors):} Surprisingly, the highest Eigenvector scores were not found in the city center, but along the \textbf{L9 Sud corridor} (Nodes: \textit{Parc Nou, Aeroport T2, Fira}). This indicates that Barcelona’s topology prioritizes high-speed connectors that link strategic economic zones (Airport, Trade Fair) to the rest of the grid, rather than funneling all influence through a single downtown hub.
\end{itemize}


\begin{figure}[H]
    \centering
   
    \begin{subfigure}{0.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{eigen1.png} 
        \caption{Barcelona}
    \end{subfigure}
    \hfill 
    \begin{subfigure}{0.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{eigen2.png}
        \caption{Milan}
    \end{subfigure}
    
    \caption{Comparison of Eigenvector Centrality in Barcelona and Milan.}
    \label{fig:comparison_map}
\end{figure}
\subsubsection{Assortativity and Network Resilience}
A key finding of this study is the mixing pattern of the networks. Both cities exhibited \textbf{positive assortativity coefficients}:
\[ r_{\text{Barcelona}} \approx 0.129, \quad r_{\text{Milan}} \approx 0.188 \]

This result is non-trivial, as many transport networks (such as airline routes) are typically disassortative. The positive values indicate a \textbf{``Rich-Club'' topology}: major hubs in both Barcelona and Milan tend to connect directly to other major hubs. This structure enhances resilience, as the core ``backbone'' of the city remains connected even if peripheral suburban branches are disrupted.



\subsubsection{Critical Infrastructure (Edge Betweenness)}
The Edge Betweenness analysis highlighted the physical vulnerabilities of the networks:

\begin{itemize}
    \item \textbf{Critical Bridges:} In both cities, the algorithm identified specific ``arteries'' (visualized in red/yellow in Figure \ref{fig:betweenness}) that carry a disproportionate amount of passenger flow. These edges represent the unique shortest paths for substantial portions of the population.
    \item \textbf{Redundancy:} Barcelona’s grid-like mesh resulted in a more distributed set of critical edges. In contrast, Milan showed higher pressure on the radial lines entering the city center, suggesting that a failure in one of Milan's central ``spokes'' would have a more catastrophic impact on global efficiency than a similar failure in Barcelona's mesh.
\begin{figure}[H]
    \centering
    
    \begin{subfigure}{0.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{betweeness1.png} 
        \caption{Barcelona}
    \end{subfigure}
    \hfill 
    \begin{subfigure}{0.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{betweeness2.png} 
        \caption{Milan}
    \end{subfigure}
    
    \caption{Edge Betweenness Centrality illustrating critical transport bottle-necks.}
    \label{fig:comparison_map}
\end{figure}




\subsubsection{Community Structure and Zoning}
Using Modularity-based clustering, we successfully partitioned the cities into functional transport zones:

\begin{itemize}
    \item \textbf{Milan (Radial Wedges):} The algorithm detected \textbf{47 communities} ($Q = 0.927$). Visually, these form ``wedges'' radiating from the center, confirming the radial nature of the network. Commuters are grouped by the specific ``arm'' of the network they utilize.
    \item \textbf{Barcelona (Interlocked Mesh):} The algorithm detected \textbf{36 communities} ($Q = 0.890$). These communities appear as interlocked, linear clusters that align with major Metro lines and transfer corridors. This reflects a polycentric city design where movement is facilitated across the grid rather than solely towards a single center.
\end{itemize}
\begin{figure}[H]
    \centering
    
    \begin{subfigure}{0.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{community.png}  
        \caption{Barcelona}
    \end{subfigure}
    \hfill 
    \begin{subfigure}{0.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{community2.png} 
        \caption{Milan}
    \end{subfigure}
    
    \caption{Community Structure and Zoning detected for both cities}
    \label{fig:comparison_map}
\end{figure}



\section{Validity Analysis}

To ensure the robustness of our Social Network Analysis (SNA), we evaluated the validity of our results through three key dimensions: data integrity, algorithmic correctness, and real-world ground truthing. 

\subsection{Data Integrity and Limitations}
The study relies on GTFS (General Transit Feed Specification) data, which is the industry standard for public transport schedules. While this ensures high accuracy regarding the \textit{planned} network topology, it presents specific limitations. The analysis treats the network as a static graph based on weekly frequencies, meaning it does not account for real-time disruptions, delays, or passenger congestion levels. Additionally, large transit hubs (such as \textit{Milano Centrale}) are treated as single aggregated nodes to accurately reflect transfer potential, though some intra-station granularity may be lost. 

\subsection{Algorithmic Verification}
   We performed specific mathematical checks to ensure the metrics were calculating correctly: 

\begin{itemize}
   \item \textbf{Assortativity (The "Rich-Club" Effect):} Both networks exhibited positive assortativity (Barcelona: $0.129$, Milan: $0.188$).  This is a significant finding. While many biological or technological networks are disassortative (hubs connect to small nodes), our results indicate that the Metro systems of Barcelona and Milan follow a "Rich-Club" topology, where major hubs preferentially connect to other major hubs. This structure creates a resilient "backbone" that keeps the network functional even if peripheral branches are cut.
    \item \textbf{Modularity Scores:} The community detection algorithm yielded exceptionally high modularity scores (Barcelona: $0.89$, Milan: $0.92$), confirming that the detected "zones" are statistically significant structural clusters rather than random artifacts.
\end{itemize}

\subsection{Ground Truthing (External Validity)}
The most significant test of validity is whether the mathematical results correspond to physical reality.
\begin{itemize}
    \item \textbf{Milan (Central Hubs):} The nodes with the highest Eigenvector Centrality were identified as \textit{Centrale FS}, \textit{Garibaldi FS}, and \textit{Zara}. These correspond exactly to the city's primary railway and metro interchange hubs, confirming the algorithm correctly identified the "center of gravity" of the network. 
    \item \textbf{Barcelona (Strategic Corridors):} Interestingly, for Barcelona, the algorithm assigned high influence to the \textit{L9 Sud corridor} (nodes: \textit{Parc Nou, Aeroport T2, Fira}). This aligns with the line's strategic role as a high-capacity connector linking the Airport and Trade Fair centers to the rest of the grid, validating the metric's ability to detect economically critical infrastructure.
\end{itemize}


\section{Conclusion}

This project applied Social Network Analysis (SNA) to compare the public transport architectures of Barcelona and Milan, revealing how distinct urban planning philosophies manifest in graph topology.

\subsection{Topological Comparison: Grid vs. Radial}
The analysis reveals a fundamental structural divergence between the two cities: 

\begin{itemize}
    \item \textbf{Barcelona (The Resilient Mesh):} The network forms a decentralized grid with 36 distinct communities. The "interlocked" nature of these communities suggests a system designed for high cross-town mobility, reducing the need for all passengers to pass through a single central point. 
    \item \textbf{Milan (The Efficient Radial):} Conversely, Milan exhibits a stronger hierarchical structure with 47 smaller communities radiating from a dense core. The high centrality of stations like \textit{Centrale FS} confirms a system optimized for centripetal flow (moving commuters in and out of the center), which is highly efficient but potentially prone to central congestion.
\end{itemize}

\subsection{Network Robustness}
The positive assortativity coefficients (Barcelona: $0.13$, Milan: $0.19$) are a key indicator of robustness. They suggest that both cities possess a strong "core backbone" where major lines interconnect directly. This is a desirable trait for resilience; if a suburban branch fails, the core network remains intact and operational, preventing cascading failures.

\subsection{Final Implications}
Our results suggest that while Milan’s radial system provides direct access to the city center, its reliance on a few "super-hubs" (like \textit{Garibaldi} and \textit{Centrale}) creates potential bottlenecks. Barcelona’s grid system, highlighted by the prominence of the \textit{L9 Airport connector} in our centrality analysis, distributes importance more evenly across strategic corridors. Future planning for Milan could benefit from "orbital" lines to mimic Barcelona’s mesh-like resilience, reducing pressure on the historic center. 


\begin{thebibliography}{9}

\bibitem{a}
GTFS Documentation: \url{https://gtfs.org}
\bibitem{b}
pandas: \url{https://pandas.com}

\bibitem{c}
pandas: \url{https://pandas.com}

\end{thebibliography}
\end{document}
